#!/usr/bin/env bash
#the installation of ngix

# Update package list
apt-get update -y

# Install nginx
apt-get install -y nginx

# Configure nginx to listen on port 80
sed -i 's/listen \[::\]\+:80 default_server;/listen 80 default_server;/' /etc/nginx/sites-available/default
sed -i 's/listen [0-9]\+:80 default_server;/listen 80 default_server;/' /etc/nginx/sites-available/default
sed -i 's/listen 80 default_server;/listen 80 default_server;/' /etc/nginx/sites-available/default #ensure the port is exactly 80.

# Create a simple HTML page with "Holberton School"
echo "<html><body>Holberton School</body></html>" > /var/www/html/index.html

# Restart nginx (without systemctl)
nginx -s reload

# Verify nginx is running and serving the correct content
if curl -s http://127.0.0.1/ | grep -q "Holberton School"; then
  echo "Nginx configured successfully."
else
  echo "Nginx configuration failed."
  exit 1
fi
